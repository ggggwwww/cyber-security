CREATE DATABASE pentestDB;
USE pentestDB;

CREATE USER 'dbmaster'@'localhost' IDENTIFIED BY '1234';
GRANT ALL PRIVILEGES ON pentestDB.* TO 'dbmaster'@'localhost';
FLUSH PRIVILEGES;

CREATE TABLE users (
    id VARCHAR(50) PRIMARY KEY UNIQUE,
    username VARCHAR(50) NOT NULL UNIQUE,
    pw VARCHAR(255) NOT NULL,
    role VARCHAR(20) DEFAULT 'patient',
    profile_image VARCHAR(255) DEFAULT '/var/www/html/profile/images/default.png'
);
CREATE TABLE boards (
    id INT AUTO_INCREMENT PRIMARY KEY,
    title VARCHAR(100) NOT NULL,
    content TEXT NOT NULL
);

CREATE TABLE patient_records (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) NOT NULL,
    record TEXT NOT NULL,
    prescription TEXT NOT NULL,
    FOREIGN KEY (username) REFERENCES users(username)
);

CREATE TABLE reservations (
    id INT AUTO_INCREMENT PRIMARY KEY,
    patient_username VARCHAR(50) NOT NULL,
    doctor_username VARCHAR(50) NOT NULL,
    reservation_date DATE NOT NULL,
    reservation_time TIME NOT NULL,
    _status VARCHAR(20) DEFAULT 'pending',
    FOREIGN KEY (patient_username) REFERENCES users(username),
    FOREIGN KEY (doctor_username) REFERENCES users(username)
);


# Sample Data
INSERT INTO users (id, username, pw, role) VALUES ('admin', 'admin', 'admin');
INSERT INTO users (id, username, pw) VALUES ('patient1', 'patient1', 'pass');
INSERT INTO users (id, username, pw, role) VALUES ('doctor1', 'doctor1', 'pass', 'doctor');

INSERT INTO boards (title, content) VALUES ('Welcome', 'This is the welcome board.');
INSERT INTO patient_records (username, record) VALUES ('patient1', 'Patient1 medical record data.');

INSERT INTO reservations (patient_username, doctor_username, reservation_date, reservation_time) VALUES ('patient1', 'doctor1', '2026-07-01', '10:00:00');