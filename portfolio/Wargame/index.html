<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta name="generator" content="Aspose.Words for .NET 25.11.0" />
    <title></title>
    <link rel="stylesheet" href="index.css" type="text/css" />
  </head>
  <body>
    <div>
      <p><span>&lt;Starmap 문제풀이&gt;</span></p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.001.png"
          width="602"
          height="401"
          alt="" />
      </p>
      <p><span class="step-title">1. cookie 변경문제</span></p>
      <p><span>- 취약점</span></p>
      <div class="vuln-box">
        <p>
          <span
            >클라이언트 측 쿠키 값이 그대로 신뢰되는 취약점(쿠키변조취약점)을
            이용해서 푸는 문제다
          </span>
        </p>
        <p>
          <span
            >즉 서버가 로그인 여부를 쿠키의 loggedin=1 여부만으로 판단하는
            구조라서, 공격자는 개발자 도구에서 쿠키값을 마음대로 바꿔서 접근
            권한을 획득할수있다.
          </span>
        </p>
      </div>
      <p><span>- 문제해결방법</span></p>
      <p>
        <span
          >개발자도구에서 Loggedin value값을 0에서 1로 바꾼뒤 페이지를
          새로고침하면 </span
        ><spanundefined>&#xa0;</span
        ><span>flag값이 나온다. </span>
      </p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.002.png"
          width="544"
          height="346"
          alt="" />
      </p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.003.png"
          width="602"
          height="66"
          alt="" />
      </p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.004.png"
          width="167"
          height="54"
          alt="" />
      </p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.005.png"
          width="485"
          height="320"
          alt="" />
      </p>
      <p class="callout"><span>=&gt; FLAG{first_cookie_1234@@}</span></p>
      <p><spanundefined>&#xa0;</span></p>
      <p><span class="step-title">2. 경로문제(LFI취약점)</span></p>
      <p><span class="sub-title">- 취약점</span></p>
      <div class="vuln-box">
        <p>
          <span
            >LIF(Local File Inclusion)취약점, 즉 파일 경로를 조작해 내부의 임의
            파일을 읽어오는 취약점을 이용해서 푸는 문제다.
          </span>
        </p>
        <p>
          <span
            >?page=../../../../../../../etc/star_webpass/cmd 처럼 경로조작을 통해
            LFI공격을 수행하여 flag를 획득한다.
          </span>
        </p>
      </div>
      <p><span class="sub-title">- 문제해결방법</span></p>
      <p>
        <span
          >View page source를 보면 주석으로 힌트를 주고있다 이를이용해서
          찾는문제이다.</span
        >
      </p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.006.png"
          width="602"
          height="425"
          alt="" /><br /><span
          >- 힌트에 /etc/star_webpass.cmd 경로에 다음 flag가 있다고 나와있으므로
          이를 이용해야한다.
        </span>
      </p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.007.png"
          width="499"
          height="49"
          alt="" />
      </p>
      <p>
        <span
          >단순히 URL에 ?page=/etc/star_webpass/cmd 를 하면 flag 가 있는
          페이지가 나오지 않지만,</span
        >
      </p>
      <p>
        <span
          >?page=../../../../../../../../etc/star_webpass/cmd 를 URL에 넣으면
          flag가 나온다.</span
        >
      </p>
      <p><spanundefined>&#xa0;</span></p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.008.png"
          width="602"
          height="428"
          alt="" />
      </p>
      <p><spanundefined>&#xa0;</span></p>
      <p class="callout"><span>FLAG{LFI_master_00002shaha} </span></p>
      <p><spanundefined>&#xa0;</span></p>
      <p><span class="step-title">3. strcmp()함수 취약점이용문제</span></p>
      <p><span class="sub-title">- 취약점</span></p>
      <div class="vuln-box">
        <p>
          <span
            >Strcmp()는 문자열 비교함수다 이 함수는 문자열이 아닌 것이 입력되면
            에러를 내고 정상 비교가 불가능하다.
          </span>
        </p>
        <p>
          <span
            >Password[]= 로 password 라는 문자열이 아니라 배열로 보내면 strcmp()는
            배열을 비교할수없어서 null을 반환하고 이상한 동작을 하며 검증이
            무력화된다</span
          >
        </p>
        <p>
          <span
            >그래서 배열이 들어온 경우를 우회 성공으로 간주해서 flag를
            출력하게된다.
          </span>
        </p>
      </div>
      <p><span class="sub-title">- 문제해결방법</span></p>
      <p class="callout">
        <span
          >Buirpsuite를 이용해서 password넣는 칸에 아무 값을 넣은후
          intercept하면 password=asdf 로되어있다. 이때</span
        ><spanundefined>&#xa0; </span
        ><span
          >password 변수를 배열로 바꿔서 Password[]=asdf 로 넣고 forward하게되면
          창에 flag가 뜨게된다.
        </span>
      </p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.009.png"
          width="602"
          height="431"
          alt="" />
      </p>
      <p><span>- 틀린 password 입력시</span></p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.010.png"
          width="602"
          height="363"
          alt="" />
      </p>
      <p><span>- burpsuite로 intercept 로 바로 잡았을 때 </span></p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.011.png"
          width="602"
          height="282"
          alt="" />
      </p>
      <p><spanundefined>&#xa0;</span></p>
      <p><span>- password변수를 배열로 바꾼 예시 </span></p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.012.png"
          width="602"
          height="283"
          alt="" />
      </p>
      <p><span>- 정상적으로 flag가 출력된다. </span></p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.013.png"
          width="602"
          height="361"
          alt="" />
      </p>
      <p class="callout"><span>FLAG{strcmp_bypass_success_9988@@}</span></p>
      <p>
        <span   >&#xa0;</span
        >
      </p>
      <p><span class="step-title">4. 인코딩방식 유출 취약점</span></p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.014.png"
          width="602"
          height="424"
          alt="" />
      </p>
      <p><span class="sub-title">- 취약점</span></p>
      <div class="vuln-box">
        <p>
          <span
            >1. 서버의 인코딩 방식이 코드에 그대로 공개되어있어 역연산이 가능하다.
          </span>
        </p>
        <pre class="code-block shell-block">function encodeSecret($secret) {
    return bin2hex(strrev(base64_encode($secret)));
}</pre>
        <p>
          <span
            >위 코드를 보면 base64_encode -&gt; reverse -&gt; hex 인코딩이
            순서대로 처리되고있다. 그래서 공격자는 이를 완전히 역연산할수있다.
          </span>
        </p>
        <p><span>2. 서버는 해시가 아니라 단순 인코딩을 사용한다. </span></p>
        <p>
          <span
            >즉 암호학적 해싱이아니라 reverse + base64 + hex 조합이라 원래값을
            구할수있다. (역정렬가능)</span
          >
        </p>
      </div>
      <p><spanundefined>&#xa0;</span></p>
      <p><span class="sub-title">- 문제 해결방법</span></p>
      <p><span>- view page source(여기서 나오는 코드를 참고해야함)</span></p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.015.png"
          width="602"
          height="248"
          alt="" />
      </p>
      <pre class="code-block shell-block">$encodedSecret = "3d4d31554242315242786b52";

function encodeSecret($secret) {
    return bin2hex(strrev(base64_encode($secret)));
}</pre>
      <p><span>encodedSecret 값을 역순으로 복구한다. </span></p>
      <p><span>1. hex decode</span></p>
      <pre class="code-block shell-block">hex2bin("3d4d31554242315242786b52")
-&gt; =M1UBB1RBxkR</pre>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.016.png"
          width="351"
          height="454"
          alt="" />
      </p>
      <p><span>2. reverse</span></p>
      <p><span>나온값을 역순으로 뒤집어준다. </span></p>
      <p><span>-&gt; RkxBR1BBU1M</span></p>
      <p><span>3. base64 decode</span></p>
      <p><span>Base64로 디코드하기 </span></p>
      <p><span>-&gt; FLAGPASS</span></p>
      <p><spanundefined>&#xa0;</span></p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.017.png"
          width="602"
          height="483"
          alt="" />
      </p>
      <p><spanundefined>&#xa0;</span></p>
      <p>
        <span
          >이제 Secret 넣는칸에 FLAGPASS 넣고 submit제출하면 flag값이 나온다.
        </span>
      </p>
      <p><span>- secret 잘못입력한경우 :</span></p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.018.png"
          width="582"
          height="302"
          alt="" />
      </p>
      <p><span>- secret 올바르게 입력한경우:</span></p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.019.png"
          width="602"
          height="64"
          alt="" />
      </p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.020.png"
          width="602"
          height="333"
          alt="" />
      </p>
      <p><span>-&gt; flag 획득</span></p>
      <p class="callout"><span>FLAG{encodeSecret_function_bypass_success_2025}</span></p>
      <p><spanundefined>&#xa0;</span></p>
      <p><span class="step-title">5. HEARTBLEED MEMORY REAK</span></p>
      <p>
        <span>-</span><spanundefined>&#xa0; </span
        ><span>취약점</span>
      </p>
      <p>
        <span
          >OpenSSL HeartBleed 취약점 – 메모리 오버리드(memory over-read)를
          이용해 만든 문제로 Length 검증 누락으로 인한 메모리 과다 읽기떄문에
          취약점이 발생한다.
        </span>
      </p>
      <pre class="code-block shell-block">
          <p><span>$payload = $_POST["payload"];</span></p>
      <p>
        <span>$length</span><spanundefined>&#xa0; </span
        ><span>= intval($_POST["length"]);</span>
      </p>
      <p><span>$merged = $payload . $SIMULATED_MEMORY;</span></p>
      <p>
        <span>$leak = substr($merged, 0, $length);</span
        ><spanundefined>&#xa0;&#xa0; </span
        ><span>// 길이 검증 없음!</span>
      </p>
      </pre>
    
      <p>
        <span
          >위 코드를 보면 payload의 실제 길이와 관계없이 length 값만큼 메모리를
          반환한다. 즉 공격자가 의도적으로 payload 길이보다 훨씬 큰 length 값을
          넣으면, 서버 내부 메모리($SIMULATED_MEMORY)가 그대로 누출된다.
        </span>
      </p>
      <p>
        <span
          >이 메모리 중간 760~900 바이트 지점에 FLAG가 있으므로 크게 요청하면
          FLAG가 같이 노출되게된다.
        </span>
      </p>
      <p><spanundefined>&#xa0;</span></p>
      <p><span class="sub-title">- 문제해결</span></p>
      <p>
        <span
          >Payload를 a 문자 하나로 줬을 때 length를 840 주면 flag로 시작하는
          앞머리가 보인다.
        </span>
      </p>
      <p><span>890 정도주게되면 flag값 전체가 보이게된다. </span></p>
      <p>
        <span
          >payload값을 많이 주게되면 그만큼 length도 위보다 더 증가해서 넣어주면
          flag값이 출력되어 확인할수있다.
        </span>
      </p>
      <p><spanundefined>&#xa0;</span></p>
      <p><span>- 첫페이지 </span></p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.021.png"
          width="592"
          height="429"
          alt="" />
      </p>
      <p><span>- payload:a , length: 840줬을 때</span></p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.022.png"
          width="598"
          height="360"
          alt="" />
      </p>
      <p><spanundefined>&#xa0;</span></p>
      <p><span>- payload:a , length: 890줬을 때</span></p>
      <p><spanundefined>&#xa0;</span></p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.023.png"
          width="581"
          height="348"
          alt="" />
      </p>
      <p><span>-&gt; 위와같이 FLAG값이 출력된다. </span></p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.024.png"
          width="602"
          height="70"
          alt="" />
      </p>
      <p>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.025.png"
          width="597"
          height="432"
          alt="" />
      </p>
      <p>
        <p class="callout"><span>-&gt; FLAG{thirdstar_heartbleed_memory_leak_success_2025}</span></p>
      </p>
      <p><spanundefined>&#xa0;</span></p>
      <p><spanundefined>&#xa0;</span></p>
      <p><spanundefined>&#xa0;</span></p>
      <p><spanundefined>&#xa0;</span></p>
      <p><spanundefined>&#xa0;</span></p>
      <p><spanundefined>&#xa0;</span></p>
      <p><spanundefined>&#xa0;</span></p>
      <p><spanundefined>&#xa0;</span></p>
      <p><spanundefined>&#xa0;</span></p>
      <p><spanundefined>&#xa0;</span></p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <p>
        <span class="step-title">#Problem 06</span
        >
      </p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <pundefined>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.026.png"
          width="554"
          height="378"
          alt="" />
      </p>
      <pundefined>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.027.png"
          width="554"
          height="442"
          alt="" />
      </p>
      <p class="callout">
        <span
          >curl 명령어를 통해 헤더의 키 값을 'admin', 나머지 값을 'yes'로
          부여해서 요청 시, FLAG를 취득 할 수 있다.
          혹은 Web Proxy 도구를 사용하여 HTTP 요청을 Intercept한 후, HTTP
          Request Body 부분을 조작하여 해당 문제의 플래그를 추출할 수도
          있다.</span
        >
      </p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <p>
        <span class="step-title"># Problem 07</span
        >
      </p>
      <pundefined>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.028.png"
          width="554"
          height="351"
          alt="" />
      </p>
      <pundefined>
        <span   >-&gt; 사용가능한 IP주소는 다음과 같다.</span
        >
      </p>
      <pundefined>
        <span   >&#xa0;</span
        ><spanundefined>- 10.0.0.8</span>
      </p>
      <pundefined>
        <span   >&#xa0;</span
        ><spanundefined>- 172.34.88.3</span>
      </p>
      <pundefined>
        <span   >&#xa0;</span
        ><spanundefined>- 192.105.40.129</span>
      </p>
      <pundefined>
        <span   >&#xa0;</span
        ><span   >=&gt; </span
        ><span   >X-Fowarded-For 헤더를 조작하여 문제를 해결할 수 있다.</span
        >
      </p>
      <pundefined>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.029.png"
          width="576"
          height="391"
          alt="" />
      </p>
      <pundefined>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.030.png"
          width="576"
          height="239"
          alt="" />
      </p>
      <pundefined>
        <span   >=&gt; </span
        ><spanundefined>FLAG 출력</span>
      </p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <pundefined>
        <span class="step-title">#Problem 08</span
        >
      </p>
      <pundefined>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.031.png"
          width="576"
          height="593"
          alt="" />
      </p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <pundefined>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.032.png"
          width="576"
          height="295"
          alt="" />
      </p>
      <pundefined>
        <span   >1. 채팅칸에 메시지를 넣고 입력하면 history 쿠키에 값이
          추가된다.</span
        >
      </p>
      <pundefined>
        <span   >2. history 쿠키의 값이 쿠키의 임계치(일반적으로 4KB이나 워게임 사이트
          코드에서는 브라우저단에서의 차단 문제 때문에 임계치를 3500B로
          제한했습니다.)의 끝을 충족하는 양의 메시지를 보내게되면 숨겨져있던
          flag 쿠키가 발생됩니다.</span
        >
      </p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <pundefined>
        <span class="step-title">#Problem 09</span
        >
      </p>
      <pundefined>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.033.png"
          width="576"
          height="201"
          alt="" />
      </p>
      <pundefined>
        <span   >1. 시작페이지에는 빈 공백이 나타납니다. 해당 페이지에 대한 정보를
          찾아보기 위해 페이지 검사를 시도해해본다.
        </span>
      </p>
      <pundefined>
        <span   >2. hidden 태그에 숨겨져 있는 input 태그를 확인한다.</span
        >
      </p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <pundefined>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.034.png"
          width="576"
          height="291"
          alt="" />
      </p>
      <pundefined>
        <span   >3. 숨겨져 있는 이메일을 확인한 후 Enter를 눌러 진행한다.</span
        >
      </p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <pundefined>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.035.png"
          width="576"
          height="165"
          alt="" />
      </p>
      <pundefined>
        <span   >4. 옳바른 이메일 입력 시 플래그가 발생하고 그렇지 않을 시
          실패합니다.</span
        >
      </p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <pundefined>
        <span class="step-title">#Problem 10</span
        >
      </p>
      <pundefined>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.036.png"
          width="576"
          height="297"
          alt="" />
      </p>
      <pundefined>
        <span   >1. 접속 시 파라미터 값에 'inc' 그리고 그에 해당하는 값으로 어떤
          이름을 넣어서 요청하라는 것 같다.</span
        >
      </p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <pundefined>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.037.png"
          width="576"
          height="152"
          alt="" />
      </p>
      <pundefined>
        <span   >2. inc 파라미터에 값을 넣어서 줘봐도 아무런 변화가 없다.</span
        >
      </p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <pundefined>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.038.png"
          width="576"
          height="230"
          alt="" /><span   >3. PHP Wrapper 기능을 이용해 inc 파라미터에 data Wrapper 기능(PHP.ini
          설정 파일에 'allow_url_include' 옵션이 ON으로 되어있다는 가정 하에.
          워게임 서버에서 설정되어있음.)을 이용해 HELLO라는 평문 텍스트 값을
          curl 명령어로 시도했을 때 '</span
        ><span   >HELLO-view.php'</span
        ><span   >라는 값이 출력되는 것을 보아 inc 파라미터 뒤에 '-view.php'라는 값이
          붙는 것을 확인할 수 있다.</span
        >
      </p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <pundefined>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.039.png"
          width="518"
          height="205"
          alt="" /><span   >('spencergallie'라는 문자는 rockyou.txt에 포함된 글자 중
          하나입니다.)</span
        >
      </p>
      <pundefined>
        <span   >4. inc 파라미터 값에 사전 공격 혹은 무차별 대입을 통해 inc 파라미터에
          해당하는 값이 'spencergallie'인 것을 확인한다. 이제 파라미터에
          대입해야할 값이 inc 외에 'proof'가 하나 더 생겼음을 알 수 있다, 또한
          '</span
        ><span   >RCE_OK_7b3c1</span
        ><span   >'이라는 토큰이 생성된 된 것을 확인할 수 있다.</span
        >
      </p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <pundefined>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.040.png"
          width="576"
          height="206"
          alt="" />
      </p>
      <pundefined>
        <span   >5. 위 과정들을 통해 우리는 서버에 'spencergallie-view.php'라는 파일이
          존재함을 확인 했고 서버단에서는 '-view.php'로 끝나는 파일이
          존재하는지에 대한 비교 검증이 완료된 후 그 파일이 존재한다면
          ob_start()라는 php의 랜더링 함수를 통해 정답 화면 템플릿이
          출력된다.</span
        >
      </p>
      <pundefined>
        <span   >6. 서버단에서는 php코드에서 proof라는 GET Parameter 값의 존재 유무를
          검증하고 최종적으로 플래그를 노출시킨다.</span
        >
      </p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <pundefined>
        <span   >--- 아래는 problem_10.php의 php코드 부분만 남겨놓았습니다. ----</span
        >
      </p>
      <pre class="code-block php-block">
        <ol type="1"undefined>
        <li >
          <spanundefined>&lt;?php</span>
        </li>
        <li >
          <span >header('Content-Type: text/html; charset=UTF-8');</span
          >
        </li>
        <li >
          <spanundefined>&#xa0;</span>
        </li>
        <li >
          <span >$inc = $_GET['inc'] ?? 'home';</span
          >
        </li>
        <li >
          <spanundefined>$base = __DIR__;</span>
        </li>
        <li >
          <spanundefined>&#xa0;</span>
        </li>
        <li >
          <span >if (preg_match('/\s|\x00/', $inc)) {</span
          >
        </li>
        <li >
          <span >&#xa0;&#xa0;&#xa0; </span
          ><span >http_response_code(400);</span
          >
        </li>
        <li >
          <span >&#xa0;&#xa0;&#xa0; </span
          ><spanundefined>exit('bad input');</span>
        </li>
        <li >
          <spanundefined>}</span>
        </li>
        <li >
          <spanundefined>&#xa0;</span>
        </li>
        <li >
          <span >// 의도적 취약: PHP 스트림 래퍼(php://, filter 체인) 차단 안
            함</span
          >
        </li>
        <li >
          <span >$target = $inc . '-view.php';</span
          >
        </li>
        <li >
          <spanundefined>&#xa0;</span>
        </li>
        <li >
          <spanundefined>// 렌더 시도</span>
        </li>
        <li >
          <spanundefined>ob_start();</span>
        </li>
        <li >
          <span >@include $target; // 존재하지 않아도 경고만</span
          >
        </li>
        <li >
          <spanundefined>$out = ob_get_clean();</span>
        </li>
        <li >
          <spanundefined>&#xa0;</span>
        </li>
        <li >
          <spanundefined>// 성공 시 화면 출력</span>
        </li>
        <li >
          <spanundefined>if ($out !== '') {</span>
        </li>
        <li >
          <span >&#xa0;&#xa0;&#xa0; </span
          ><spanundefined>echo $out;</span>
        </li>
        <li >
          <spanundefined>} else {</span>
        </li>
        <li >
          <span >&#xa0;&#xa0;&#xa0; </span
          ><span >echo "&lt;h1&gt;Viewer&lt;/h1&gt;";</span
          >
        </li>
        <li >
          <span >&#xa0;&#xa0;&#xa0; </span
          ><span >echo "&lt;p&gt;Try different templates via
            ?inc=NAME&lt;/p&gt;";</span
          >
        </li>
        <li >
          <spanundefined>}</span>
        </li>
        <li >
          <spanundefined>&#xa0;</span>
        </li>
        <li >
          <span >// RCE 증거를 감지해 FLAG 노출(의도된 정답 검증)</span
          >
        </li>
        <li >
          <span >if (isset($_GET['proof'])) {</span
          >
        </li>
        <li >
          <span >&#xa0;&#xa0;&#xa0; </span
          ><span >// 사용자가 실행 결과로 정확히 이 토큰을 화면에 뿌리면 FLAG를
            보여준다</span
          >
        </li>
        <li >
          <span >&#xa0;&#xa0;&#xa0; </span
          ><span >if (strpos($out, 'PROOF:RCE_OK_7b3c1') !== false) {</span
          >
        </li>
        <li >
          <span >&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span
          ><span >echo "&lt;hr&gt;&lt;p&gt;FLAG:
            flag{filter_chain_master}&lt;/p&gt;";</span
          >
        </li>
        <li >
          <span >&#xa0;&#xa0;&#xa0; </span
          ><spanundefined>}</span>
        </li>
        <li >
          <spanundefined>}</span>
        </li>
        <li >
          <spanundefined>?&gt;</span>
        </li>
      </ol>
      </pre>
      
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <pundefined>
        <span   >&#xa0;</span
        >
      </p>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <p>
        <span class="step-title">Problem_11</span>
      </p>
      <pundefined>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.041.png"
          width="602"
          height="518"
          alt="" /><span>XSS 공격 (필터링 기능을 갖춘 반사형 XSS 취약점)</span>
      </p>
      <p><spanundefined>&#xa0;</span></p>
      <pre class="code-block shell-block">&lt;/textarea&gt;&lt;img src=x onerror="document.getElementById('flagoutput').innerHTML='&lt;h3&gt;Flag: '+star_flag+'&lt;/h3&gt;'"</pre></span
        >
      </p>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <p>
        <span class="step-title">Problem_12</span>
      </p>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <pundefined>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.042.png"
          width="602"
          height="527"
          alt="" />
      </p>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <div class="vuln-box">
        <p><span>SQLi 공격 (union)</span></p>
      </div>
      <pundefined>
        <span>Username : </span>
      </p>
      <pundefined>
        <pre class="code-block shell-block">
          <span   ></span
        ><span   >&#xa0; </span
        >
          </pre>
        <spanundefined>대입</span>
      </p>
      <pundefined>
        <span>Password : </span>
      </p>
      <pundefined>
        <spanundefined>1</span
        ><spanundefined> 대입</span>
      </p>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <p>
        <span class="step-title">Problem_13</span>
      </p>
      <pundefined>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.043.png"
          width="602"
          height="437"
          alt="" />
      </p>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <p undefined      >
        <spanundefined>Broken Access Control (IDOR) </span>
      </p>
      <pundefined>
        <span>Brute-Forcing 공격을 통해 </span>
      </p>
      <pundefined>
        <span>Parameter 이름 획득 -&gt; zone, secret</span>
      </p>
      <pundefined>
        <span   >localhost/starmap/problem_13.php?zone=secret</span
        ><spanundefined> 로 이동</span>
      </p>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <p>
        <span class="step-title">Problem_14</span>
      </p>
      <pundefined>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.044.png"
          width="602"
          height="492"
          alt="" />
      </p>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <p undefined      >
        <span   >Server-Side Request Forgery (SSRF)</span
        >
      </p>
      <pundefined>
        <spanundefined>URL 미리보기 기능과 같이,</span
        ><spanundefined>&#xa0;</span
        ><spanundefined>사용자 입력 URL을 받아서</span
        ><spanundefined>&#xa0;</span
        ><spanundefined>서버가 내부적으로 요청을 수행</span>
      </p>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <pundefined>
        <a
          href="var/www/html/starmap/admin_flag.txt"   ><span
            class="Hyperlink" >file:///var/www/html/starmap/admin_flag.txt</span
          ></a
        ><span> 입력 후 플래그 값 획득</span>
      </p>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <p>
        <span class="step-title">Problem_15</span>
      </p>
      <pundefined>
        <img
          src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.045.png"
          width="602"
          height="492"
          alt="" />
      </p>
      <h2undefined>
        <span   >Insecure Direct Object Reference (IDOR) 파일 업로드 취약점</span
        >
      </h2>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <pundefined>
        <span>파일을 업로드하고 다운을 받다보면 경로를 알 수 있다. </span>
      </p>
      <pundefined>
        <span
          >../uploads15?file_id=? 와 같은 형식으로 파일을 다운받게된다.</span
        >
      </p>
      <pundefined>
        <span
          >id=1, id=2 를 다운받고 내용을 확인한 후 id=3을 확인하면 플래그값이
          나타난다</span
        >
      </p>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <pundefined>
        <span   >/uploads15?file_id=3</span
        >
      </p>
      <pundefined>
        <spanundefined>&#xa0;</span>
      </p>
      <p><spanundefined>&#xa0;</span></p>
      <table
        cellspacing="0"
        cellpadding="0"
        class="TableGrid" undefined      >
        <tr>
          <td   >
            <pundefined>
              <span class="step-title">Problem 16</span>
            </p>
            <pundefined>
              <span
                >---------------------------------------------------------------------------------------------------------</span
              >
            </p>
            <pundefined>
              <img
                src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.046.png"
                width="561"
                height="292"
                alt=""   />
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span>문제 16번 기본 화면 </span>
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span
                >힌트에 개발자가 디버그를 목적으로 숨겨둔 내용이 있을 수 있다.
                찾아라
              </span>
            </p>
            <p
              class="ListParagraph" >
              <span
                >= 특정 조건을 충족하면 해결이 된다. url 파라미터,
                http파라미터로 debug켜기 </span
              ><spanundefined>&#xa0; </span>
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span>debug=true를 URL박스에 추가 입력</span>
            </p>
            <pundefined>
              <img
                src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.047.png"
                width="562"
                height="293"
                alt=""   />
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span>페이지 소스를 확인하라고 함 </span>
            </p>
            <pundefined>
              <spanundefined>&#xa0;</span>
            </p>
            <pundefined>
              <img
                src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.048.png"
                width="332"
                height="36"
                alt=""   />
            </p>
            <pundefined>
              <spanundefined>&#xa0;</span>
            </p>
            <pundefined>
              <spanundefined>&#xa0;</span>
            </p>
            <pundefined>
              <span
                >============================================================</span
              >
            </p>
            <pundefined>
              <spanundefined>&#xa0;</span>
            </p>
            <pundefined>
              <span class="step-title">Problem 17</span>
            </p>
            <pundefined>
              <span
                >-----------------------------------------------------------------------------------------------------------</span
              >
            </p>
            <pundefined>
              <img
                src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.049.png"
                width="484"
                height="256"
                alt=""   />
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span>17번 기본 화면 ‘</span>
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span>현재 우리는 유저이고 권한이 없음 </span>
            </p>
            <pundefined>
              <img
                src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.050.png"
                width="602"
                height="79"
                alt=""   />
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span
                >개발자 도구 쿠키를 보면 role_hex와 옆에 값이 하나 있음
              </span>
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span>75736572가 뭔지 확인해보자 단, hex일 확률이 높다 </span>
            </p>
            <pundefined>
              <img
                src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.051.png"
                width="266"
                height="63"
                alt=""   />
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span>유저는 접근 권한이 없다고 했다. </span>
            </p>
            <p
              class="ListParagraph" >
              <span>그렇다면 admin을 hex값으로 변환해보자. </span>
            </p>
            <p
              class="ListParagraph" >
              <span>= 61646d696e</span>
            </p>
            <p
              class="ListParagraph" >
              <span>= 이걸 value자리에 넣으면</span>
            </p>
            <pundefined>
              <img
                src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.052.png"
                width="466"
                height="133"
                alt=""   />
            </p>
            <pundefined>
              <spanundefined>&#xa0;</span>
            </p>
            <pundefined>
              <img
                src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.053.png"
                width="465"
                height="39"
                alt=""   />
            </p>
            <pundefined>
              <spanundefined>&#xa0;</span>
            </p>
            <pundefined>
              <spanundefined>&#xa0;</span>
            </p>
            <pundefined>
              <spanundefined>&#xa0;</span>
            </p>
            <pundefined>
              <span class="step-title">Problem 18</span>
            </p>
            <pundefined>
              <span
                >-----------------------------------------------------------------------------------------------------------</span
              >
            </p>
            <pundefined>
              <img
                src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.054.png"
                width="602"
                height="263"
                alt=""   />
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span>기본 페이지이다 </span>
            </p>
            <pundefined>
              <img
                src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.055.png"
                width="458"
                height="49"
                alt=""   />
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span>이전에 사용한 debug는 true를 넣어보자 </span>
            </p>
            <pundefined>
              <img
                src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.056.png"
                width="209"
                height="181"
                alt=""   />
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span>UID의 종류를 알려준다. </span>
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span>1: guest, 2: guest, 3: admin</span>
            </p>
            <pundefined>
              <img
                src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.057.png"
                width="330"
                height="179"
                alt=""   />
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span>Uid을 3으로하고 들어가면 플래그를 찾을 수 있다. </span>
            </p>
            <pundefined>
              <spanundefined>&#xa0;</span>
            </p>
            <pundefined>
              <spanundefined>&#xa0;</span>
            </p>
            <pundefined>
              <spanundefined>&#xa0;</span>
            </p>
            <pundefined>
              <span class="step-title">Problem 19</span>
            </p>
            <pundefined>
              <span
                >-----------------------------------------------------------------------------------------------------------</span
              >
            </p>
            <pundefined>
              <img
                src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.058.png"
                width="517"
                height="161"
                alt=""   />
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span>기본 화면 </span>
            </p>
            <pundefined>
              <img
                src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.059.png"
                width="399"
                height="115"
                alt=""   />
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span
                >개발자도구를 통해 힌트를 얻을 수 있음, Uid=1을 url에 넣어보자.
              </span>
            </p>
            <pundefined>
              <img
                src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.060.png"
                width="433"
                height="216"
                alt=""   />
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span>시그니처의 형태가 일반적인 형태라 보기에는 어렵다</span>
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span
                >힌트 부분에 보면 md5로 암호화 되어있음을 볼 수 있다.
              </span>
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span
                >콘솔 부분을 보면 easy123역시 유추할 수 있다. 거기에
                uid=3(admin) 더한게 우리가
              </span>
            </p>
            <p
              class="ListParagraph" >
              <span>목적으로 하는 secretkey가 된다. =easy1233</span>
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span>Easy1233을 md5로 암호화해보자 </span>
            </p>
            <pundefined>
              <img
                src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.061.png"
                width="319"
                height="64"
                alt=""   />
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span>얻은 시그니처와 admin을 바탕으로 url작성 =</span>
            </p>
            <p
              class="ListParagraph" >
              <a
                href="http://192.168.16.53/starmap/problem_19.php?uid=3&amp;sig=665c0a0e59aa68c34fbfa1f9031df4e0"     ><span class="Hyperlink"
                  >http://192.168.16.53/starmap/problem_19.php?uid=3&amp;sig=665c0a0e59aa68c34fbfa1f9031df4e0</span
                ></a
              >
            </p>
            <pundefined>
              <img
                src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.062.png"
                width="281"
                height="50"
                alt=""   />
            </p>
            <pundefined>
              <spanundefined>&#xa0;</span>
            </p>
            <pundefined>
              <span class="step-title">Problem 20</span>
            </p>
            <pundefined>
              <span
                >-----------------------------------------------------------------------------------------------------------</span
              >
            </p>
            <pundefined>
              <img
                src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.063.png"
                width="469"
                height="277"
                alt=""   />
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span>20번 기본화면 </span>
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span
                >Serverlog 부분에 secret: c2VJcmV0aV5NDU2는 base64로 변환된 것을
                추정</span
              >
            </p>
            <pundefined>
              <img
                src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.064.png"
                width="337"
                height="67"
                alt=""   />
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span>Secretkey456이란 것을 얻었음 </span>
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span
                >이제 생각해볼 부분은 얻은 정보와 힌트라고 적힌 부분을 조합
              </span>
            </p>
            <pundefined>
              <img
                src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.065.png"
                width="529"
                height="75"
                alt=""   />
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span>토큰 값을 얻었음 </span>
            </p>
            <p
              class="ListParagraph" >
              <span     ><span><spanundefined></span></span
                ><span       >&#xa0;&#xa0;&#xa0;&#xa0;
                </span></span
              ><span>url창에 얻은 토큰 값을 삽입 </span>
            </p>
            <pundefined>
              <span
                >http://192.168.16.53/starmap/problem_20.php?token=8541913d82c341efb890f71021fef025d44e7427beb8b03a9e3d55b783032898</span
              >
            </p>
            <pundefined>
              <img
                src="images/Aspose.Words.3078c997-4886-4ead-9a7e-13e74d52f79e.066.png"
                width="558"
                height="82"
                alt=""   />
            </p>
            <pundefined>
              <spanundefined>&#xa0;</span>
            </p>
          </td>
        </tr>
      </table>
      <p><spanundefined>&#xa0;</span></p>
    </div>
  </body>
</html>
