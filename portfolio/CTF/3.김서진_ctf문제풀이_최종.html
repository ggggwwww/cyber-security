<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Malgun Gothic";
	panose-1:2 11 5 3 2 0 0 2 0 4;}
@font-face
	{font-family:"Fira Mono";
	panose-1:2 11 5 9 5 0 0 2 0 4;}
@font-face
	{font-family:"\@Malgun Gothic";}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:107%;
	text-autospace:none;
	word-break:break-all;
	font-size:10.0pt;
	font-family:"Malgun Gothic",sans-serif;}
a:link, span.MsoHyperlink
	{color:#0563C1;
	text-decoration:underline;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:40.0pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:107%;
	text-autospace:none;
	word-break:break-all;
	font-size:10.0pt;
	font-family:"Malgun Gothic",sans-serif;}
.MsoChpDefault
	{font-size:10.0pt;
	font-family:"Malgun Gothic",sans-serif;}
.MsoPapDefault
	{margin-bottom:8.0pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:107%;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:85.05pt 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link="#0563C1" vlink="#954F72" style='word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal style='margin-left:10.0pt;text-indent:-10.0pt'>1. <span
lang=KO>앞사람의 모달에서 다음페이지는 </span>game.php<span lang=KO>라고 힌트를주었고 앞사람 </span>flag<span
lang=KO>를 풀면 비밀번호 </span></p>

<p class=MsoNormal style='margin-left:10.0pt;text-indent:-10.0pt'>luckforyournext_!21!
<span lang=KO>가 나오는데 이거를 </span>game.php <span lang=KO>페이지 들어갈 때 입력하면된다</span>.
</p>

<p class=MsoNormal style='margin-left:10.0pt;text-indent:-10.0pt'> <img
width=492 height=327 id="그림 2" src="3.김서진_ctf문제풀이_최종_files/image001.jpg"></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><img width=528 height=351 id="그림 4"
src="3.김서진_ctf문제풀이_최종_files/image002.jpg"></p>

<p class=MsoNormal><span lang=KO>그럼 위와같이</span> game.php <span lang=KO>페이지가 뜬다</span>.
</p>

<p class=MsoNormal style='margin-left:10.0pt;text-indent:-10.0pt'>2. <span
lang=KO>첫번째 사진으로 들어가면 </span>mirro.php<span lang=KO>페이지가 뜬다</span>. <span
lang=KO>이 페이지의 미로를 탈출하면 </span>flag<span lang=KO>로</span>`uvrebtylcuvp` <span
lang=KO>가나오는데 이거를 </span>ROT13<span lang=KO>으로 디코딩하면 </span>`hieroglyphic(<span
lang=KO>이집트상형문자</span>-<span lang=KO>다음페이지암호힌트</span>)`<span lang=KO>가 나온다</span>.
<span lang=KO>이거는 다음페이지의 비번이다</span>. (<span lang=KO>다음페이지는 </span>chamber.php)</p>

<p class=MsoNormal style='margin-left:10.0pt;text-indent:-10.0pt'><img
width=248 height=371 id="그림 3" src="3.김서진_ctf문제풀이_최종_files/image003.jpg"><img
width=247 height=370 id="그림 5" src="3.김서진_ctf문제풀이_최종_files/image004.jpg"></p>

<p class=MsoNormal>3. game.php<span lang=KO>에서 두번째 사진을 클릭하면 </span>image.php<span
lang=KO>페이지가 나온다</span>. </p>

<p class=MsoNormal><span lang=KO>이때 그림의 여기저기를 눌러보면 모달창이 하나 나오는데 다음페이지는 </span>`chamber`<span
lang=KO>라고 힌트가 나온다</span>. </p>

<p class=MsoNormal><span lang=KO>그러면 이때까지 </span>.php<span lang=KO>로 페이지 열던 것을 보아
</span>chamber.php<span lang=KO>로 유추하여 페이지로 이동할것이다 그러면 방금 얻은 비번</span>(`hieroglyphic
‘)<span lang=KO>을 넣어 접속하면된다</span>. </p>

<p class=MsoNormal><img width=314 height=218 id="그림 16"
src="3.김서진_ctf문제풀이_최종_files/image005.jpg"></p>

<p class=MsoNormal><img width=178 height=123 id="그림 15"
src="3.김서진_ctf문제풀이_최종_files/image006.png"> <span lang=KO>이부분클릭시</span></p>

<p class=MsoNormal><img width=250 height=163 id="그림 14"
src="3.김서진_ctf문제풀이_최종_files/image007.jpg"> <span lang=KO>이렇게 다음페이지 힌트가뜬다</span>.
</p>

<p class=MsoNormal>4. chamber.php <span lang=KO>페이지에 접속하면 어떤 암호문이 보이는데 이것은 이집트 암호이다</span>.
<span lang=KO>인터넷에 서치해보면 암호문표가 나올것이고 그것을 해석하면 </span>`artifact`<span lang=KO>라는
</span>flag<span lang=KO>를 얻게된다</span>. </p>

<p class=MsoNormal><span lang=KO>그리고 화면 오른쪽 아래 특정부분을 클릭하게되면 다음방은 </span>Tomb <span
lang=KO>라고 힌트가 나온다</span>. <span lang=KO>이게 다음페이지 </span>Tomb.php<span lang=KO>의
힌트이다</span>. </p>

<p class=MsoNormal><img width=424 height=264 id="그림 18"
src="3.김서진_ctf문제풀이_최종_files/image008.jpg"></p>

<p class=MsoNormal><img width=85 height=153 id="그림 17"
src="3.김서진_ctf문제풀이_최종_files/image009.png"> <span lang=KO>여기를 클릭하면 </span></p>

<p class=MsoNormal><img width=273 height=173 id="그림 19"
src="3.김서진_ctf문제풀이_최종_files/image010.jpg"> <span lang=KO>이렇게 모달창이뜬다</span>. </p>

<p class=MsoNormal><span lang=KO>다음페이지이름 </span>Tomb<span lang=KO>를 알수있다</span>.
</p>

<p class=MsoNormal>5. Tomb.php<span lang=KO>에 접속하여 아까 얻은 </span>artifact <span
lang=KO>암호를 넣으면 파일업로드하는 페이지가보인다</span>. </p>

<p class=MsoNormal><span lang=KO>파일업로드는 권한이 없기 때문에 업로드하지 못하는 페이지이다</span>. <span
lang=KO>하지만 </span>upload.phpp <span lang=KO>파일을 서버측에서 세션</span>/<span lang=KO>권한
체크하지 않기 때문에 누구나 직접 </span>POST/upload.php <span lang=KO>로 파일을 올릴수있다는 취약점이 있는 것을
이용하는것이다</span>.</p>

<p class=MsoNormal><img width=359 height=199 id="그림 7"
src="3.김서진_ctf문제풀이_최종_files/image011.jpg"></p>

<p class=MsoNormal> </p>

<p class=MsoNormal>6. <span lang=KO>사용자가 아무 </span>test.php <span lang=KO>파일을 만들어서
</span>curl<span lang=KO>을 통해 파일을 올리면 </span>/uploads <span lang=KO>페이지로 들어가보면 파일이
업로드 된 것을 확인가능하다</span>. </p>

<p class=MsoNormal><span lang=KO>이때 </span>/uploads<span lang=KO>파일은 </span>dirb
<a href="http://192.168.16.54">http://192.168.16.54</a> <span lang=KO>하면 </span>/uploads
<span lang=KO>파일이나온다</span>. </p>

<p class=MsoNormal><img border=0 width=461 height=71 id="그림 1"
src="3.김서진_ctf문제풀이_최종_files/image012.png"></p>

<p class=MsoNormal>1) vi test.php</p>

<p class=MsoNormal><img border=0 width=314 height=191 id="그림 11"
src="3.김서진_ctf문제풀이_최종_files/image013.jpg"></p>

<p class=MsoNormal><span style='font-size:11.5pt;line-height:107%;font-family:
"Fira Mono";color:#212529;letter-spacing:-.05pt;background:#E9ECEF'>2) curl -v
-F &quot;file=@./test.php;filename=shell.php&quot; </span><a
href="http://192.168.16.15/upload.php"><span style='font-size:11.5pt;
line-height:107%;font-family:"Fira Mono";letter-spacing:-.05pt;background:#E9ECEF'>http://192.168.16.15/upload.php</span></a></p>

<p class=MsoNormal><span style='font-size:11.5pt;line-height:107%;font-family:
"Fira Mono";color:#212529;letter-spacing:-.05pt;background:#E9ECEF'>3) /uploads
</span><span lang=KO style='font-size:11.5pt;line-height:107%;color:#212529;
letter-spacing:-.05pt;background:#E9ECEF'>페이지</span><span lang=KO
style='font-size:11.5pt;line-height:107%;font-family:"Fira Mono";color:#212529;
letter-spacing:-.05pt;background:#E9ECEF'> </span><span lang=KO
style='font-size:11.5pt;line-height:107%;color:#212529;letter-spacing:-.05pt;
background:#E9ECEF'>접속</span></p>

<p class=MsoNormal><img border=0 width=352 height=193 id="그림 12"
src="3.김서진_ctf문제풀이_최종_files/image014.jpg"></p>

<p class=MsoListParagraph style='margin-left:38.0pt;text-indent:-.25in'><span
style='font-size:11.5pt;line-height:107%;font-family:Wingdings;color:#212529'>è<span
style='font:7.0pt "Times New Roman"'> </span></span><span lang=KO>파일업로드된공간에 </span>shell.php
<span lang=KO>파일이 업로드된 것을 확인가능</span></p>

<p class=MsoNormal>4) shell.php <span lang=KO>들어가보면 </span>flag <span lang=KO>출력된것을
확인가능 이 </span>flag<span lang=KO>는 다음단계에서 사용자 비밀번호로 사용된다</span>. </p>

<p class=MsoNormal><img border=0 width=316 height=127 id="그림 13"
src="3.김서진_ctf문제풀이_최종_files/image015.png"></p>

</div>

</body>

</html>
